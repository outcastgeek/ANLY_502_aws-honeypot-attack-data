---
title: "ANLY 500 Lab 1"
author:
- name: Akpany Benjamin Ebby
  affiliation: Harrisburg University of Science and Technology (Master of Science in Analytics)
date: "`r format(Sys.time(), '%B %d, %Y')`"
output:
  pdf_document:
    highlight: tango
    toc: true
    toc_depth: 2
    number_sections: false
    fig_width: 7
    fig_height: 6
    fig_caption: true
    template: resources/svm-latex-ms.tex
comment: Rmd Document with Markdown + Embedded R Code
# spacing: double
bibliography: resources/biblio.bib
biblio-style: apsr
---
\fontsize{8}{11}
\fontseries{b}
\selectfont
\sffamily

## Lab 1 Report as of `r Sys.Date()` based on excercise from @BusinessAnalytics_2016

```{r setup, include=FALSE, purl=FALSE, eval=TRUE}

source('R/ANLY500_Lab1_Helper.R')

```

```{r echo=FALSE}

library(knitr)
library(printr)
library(formatR)
read_chunk('R/ANLY500_Lab1_Chunks.R')

```

*Install the Required Libraries if not installed*
```{r installLibraries}
```

*Load the Required Libraries*
```{r}

library(readxl)
library(ggplot2)
library(stats)
library(pastecs)
library(reshape2)

```

The following helper functions will be used in support of the code snippets throughout the document:
```{r helperFunctions}
```

#Chapter 1

###*Set Data File Name:*

```{r}

perfFileName <- "Performance Lawn Equipment Database.xlsx"

```

###*Dealer Satisfaction Sheet*

```{r}

# Dealer Satisfaction
DealerSat <- loadSheetFromFile(perfFileName, sheet = " Dealer Satisfaction", skip = 1)
str(DealerSat) #Good way to quickly show the structure of something
#summary(DealerSat)
#head(DealerSat)
#stat.desc(DealerSat)
#View(DealerSat)

```

###*End-User Satisfaction*

```{r}

#Method 1 - Remove Rows from the top section if a dataframe. use the skip = function
EndUserSat <- loadSheetFromFile(perfFileName, sheet = "End-User Satisfaction", skip = 1)
str(EndUserSat)
#View(EndUserSat)

#Method 2 - Remove Rows

```

###*2014 Customer Survey Sheet:*

```{r}

CustomerSurvey2014 <- loadSheetFromFile(perfFileName, sheet = "2014 Customer Survey", skip = 1)
str(CustomerSurvey2014)

```

###*Complaints Sheet:*

```{r}

Complaints <- loadSheetFromFile(perfFileName, sheet = "Complaints", skip = 1)
str(Complaints)

```

###*Mower Unit Sales Sheet:*

```{r}

MowerUnitSales <- loadSheetFromFile(perfFileName, sheet = "Mower Unit Sales", skip = 1)
str(MowerUnitSales)

```

###*Tractor Unit Sales Sheet:*

```{r}

TractorUnitSales <- loadSheetFromFile(perfFileName, sheet = "Tractor Unit Sales", skip = 1)
str(TractorUnitSales)

```

###*Industry Mower Total Sales Sheet:*

```{r}

IndustryMowerTotalSales <- loadSheetFromFile(perfFileName, sheet = "Industry Mower Total Sales", skip = 1)
str(IndustryMowerTotalSales)

```

###*Industry Tractor Total Sheet:*

```{r}

IndustryTractorTotalSales <- loadSheetFromFile(perfFileName, sheet = "Industry Tractor Total Sales", skip = 1)
str(IndustryTractorTotalSales)

```

###*Unit Production Costs Sheet:*

```{r}

UnitProductionCosts <- loadSheetFromFile(perfFileName, sheet = "Unit Production Costs", skip = 1)
str(UnitProductionCosts)

```

###*Operating & Interest Expenses Sheet:*

```{r}

OperatingAndInterestExpenses <- loadSheetFromFile(perfFileName, sheet = "Operating & Interest Expenses", skip = 1)
str(OperatingAndInterestExpenses)

```

###*On-Time Delivery Sheet:*

```{r}

OnTimeDelivery <- loadSheetFromFile(perfFileName, sheet = "On-Time Delivery", skip = 1)
str(OnTimeDelivery)

```

###*Defects After Delivery Sheet:*

```{r}

DefectsAfterDelivery <- loadSheetFromFile(perfFileName, sheet = "Defects After Delivery", skip = 1)
str(DefectsAfterDelivery)

```

###*Time to Pay Suppliers Sheet:*

```{r}

TimeToPaySuppliers <- loadSheetFromFile(perfFileName, sheet = "Time to Pay Suppliers", skip = 1)
str(TimeToPaySuppliers)

```

###*Response times to customer service calls Sheet:*

```{r}

ResponseTimesCSC <- loadSheetFromFile(perfFileName, sheet = "Response Time", skip = 1)
str(ResponseTimesCSC)

```

###*Employee Satisfaction Results Sheet:*

```{r}

EmployeeSatisfaction <- loadSheetFromFile(perfFileName, sheet = "Employee Satisfaction", skip = 1)
str(EmployeeSatisfaction)

```

###*Engine Production Time Sheet:*

```{r}

EngineProductionTime <- loadSheetFromFile(perfFileName, sheet = "Engines", skip = 1)
str(EngineProductionTime)

```

###*Unit Tractor Transmission Costs Sheet:*

```{r}

TransmissionCosts <- loadSheetFromFile(perfFileName, sheet = "Transmission Costs", skip = 1)
str(TransmissionCosts)

```

###*Blade Weight Sheet:*

```{r}

BladeWeight <- loadSheetFromFile(perfFileName, sheet = "Blade Weight", skip = 1) #Skip 1 skips the first row
str(BladeWeight)
#View(BladeWeight)

```

###*Mower Test Functional Performance Sheet:*

```{r}

MowerTest <- loadSheetFromFile(perfFileName, sheet = "Mower Test", skip = 1)
str(MowerTest)

```

###*Employee Retention Sheet:*

```{r}

EmployeeRetention <- loadSheetFromFile(perfFileName, sheet = "Employee Retention", skip = 1)
str(EmployeeRetention)

```

###*Unit Shipping Cost Sheet:*

```{r}

UnitShippingCost <- loadSheetFromFile(perfFileName, sheet = "Shipping Cost", skip = 1)
str(UnitShippingCost)

```

###*Fixed Costs of Capacity Increase or New Construction Sheet:*

```{r}

FixedCost <- loadSheetFromFile(perfFileName, sheet = "Fixed Cost", skip = 1)
str(FixedCost)

```

###*Purchasing Survey Sheet:*

```{r}

PurchasingSurvey <- loadSheetFromFile(perfFileName, sheet = "Purchasing Survey", skip = 1)
str(PurchasingSurvey)

```

#Chapter 2

### Step 1

```{r}

y2010 <- DealerSat[ which(DealerSat$Year == 2010), ]
y2010

y2010L0 <- sum(y2010[,3])
y2010L0

```

### Step 2

```{r}

y <- t(sapply(MowerTest[-1], function(x) table(factor(x, levels=c("Pass", "Fail")))))
y

y2 <- as.data.frame(y)
y2
str(y2)
sum(y2$Fail)
sum(y2$Pass)

```

### Step 3

```{r}

str(MowerUnitSales)
summary(MowerUnitSales)

str(TractorUnitSales)
summary(TractorUnitSales)

## Where is the Prices data coming from?

str(UnitProductionCosts)
summary(UnitProductionCosts)

# Maybe
Prices <- UnitProductionCosts

str(Prices)
summary(Prices)

## Prices
## Prices[1:2]
## Prices[1:12,2]
## Prices[1,2]
## Prices[1:1,2:1]

## mowerRev2010 <- MowerUnitSales[1:12, 3:7] * Prices[1:12,2]

## tractorPrice <- Prices[1,2]
## tractorPrice
## MowerUnitSales[1:12, 3:7] * tractorPrice

Prices$Tractor[1]
MowerUnitSales[1:12, 3:7] * Prices$Tractor[1]
MowerUnitSales[1:12, 3:7] * Prices$Tractor[1:12]

#mowerRev2010 <- MowerUnitSales[1:12, 3:8] * Prices[1,2] # ????
#mowerRev2010

```

### Step 4

apply the sum function to find the market share of both the Mower and Tractor

#Chapter 3

## Part 1

You have been tasked with putting together an overview of PLEâ€™s business performance and market position.  You have specifically been asked to construct appropriate charts and summarize your conclusions for:
a.	Dealer Satisfaction
b.	End-User Satisfaction
c.	Complaints
d.	Mower Unit Sales
e.	Tractor Unit Sales
f.	On-Time Delivery
g.	Defects after Delivery
h.	Response Time

### Step 1

Data Structure of Dealer Satisfaction, End-User Satisfaction, Complaints, Mower Unit Sales, Tractor Unit Sales, On-Time Delivery, Defects after Delivery, Response Time:

```{r}

str(DealerSat)
str(EndUserSat)
str(Complaints)
str(MowerUnitSales)
str(TractorUnitSales)
str(OnTimeDelivery)
str(DefectsAfterDelivery)
str(ResponseTimesCSC)

```

Massage the Data for Plotting:

##**Dealer Satisfaction by Region:**

Prepare Data for the different Regions:

```{r}

yearsCols <- c("2010", "2011", "2012", "2013", "2014")
dataTags <- c("Level", "Year", "Counts")

```

###*North America:*

```{r}

naDealerSat <- regionData(DealerSat, 1,5, 3,8, yearsCols,dataTags)
ggplot(naDealerSat, aes(x=Year, y=Counts)) + geom_bar(aes(fill=Level), position="dodge", stat="identity")
ggplot(naDealerSat, aes(x=Year, y=Counts)) + geom_bar(aes(fill=Level), stat="identity")

```

###*South America:*

```{r}

saDealerSat <- regionData(DealerSat, 6,10, 3,8, yearsCols,dataTags)
ggplot(saDealerSat, aes(x=Year, y=Counts)) + geom_bar(aes(fill=Level), position="dodge", stat="identity")
ggplot(saDealerSat, aes(x=Year, y=Counts)) + geom_bar(aes(fill=Level), stat="identity")

```

###*Europe:*

```{r}

euDealerSat <- regionData(DealerSat, 11,15, 3,8, yearsCols,dataTags)
ggplot(euDealerSat, aes(x=Year, y=Counts)) + geom_bar(aes(fill=Level), position="dodge", stat="identity")
ggplot(euDealerSat, aes(x=Year, y=Counts)) + geom_bar(aes(fill=Level), stat="identity")

```

###*Pacific Rim:*

```{r}

prDealerSat <- regionData(DealerSat, 16,20, 3,8, yearsCols,dataTags)
ggplot(prDealerSat, aes(x=Year, y=Counts)) + geom_bar(aes(fill=Level), position="dodge", stat="identity")
ggplot(prDealerSat, aes(x=Year, y=Counts)) + geom_bar(aes(fill=Level), stat="identity")

```

###*China:*

```{r}

yearsInChinaCols <- c("2012", "2013", "2014")

chDealerSat <- regionData(DealerSat, 21,23, 3,8, yearsInChinaCols,dataTags)
ggplot(chDealerSat, aes(x=Year, y=Counts)) + geom_bar(aes(fill=Level), position="dodge", stat="identity")
ggplot(chDealerSat, aes(x=Year, y=Counts)) + geom_bar(aes(fill=Level), stat="identity")

```

##**Dealer Satisfaction by Region:**

###*North America:*

```{r}

naEndUserSat <- regionData(EndUserSat, 1,5, 3,8, yearsCols,dataTags)
ggplot(naEndUserSat, aes(x=Year, y=Counts)) + geom_bar(aes(fill=Level), position="dodge", stat="identity")
ggplot(naEndUserSat, aes(x=Year, y=Counts)) + geom_bar(aes(fill=Level), stat="identity")

```

###*South America:*

```{r}

saEndUserSat <- regionData(EndUserSat, 6,10, 3,8, yearsCols,dataTags)
ggplot(saEndUserSat, aes(x=Year, y=Counts)) + geom_bar(aes(fill=Level), position="dodge", stat="identity")
ggplot(saEndUserSat, aes(x=Year, y=Counts)) + geom_bar(aes(fill=Level), stat="identity")

```

###*Europe:*

```{r}

euEndUserSat <- regionData(EndUserSat, 11,15, 3,8, yearsCols,dataTags)
ggplot(euEndUserSat, aes(x=Year, y=Counts)) + geom_bar(aes(fill=Level), position="dodge", stat="identity")
ggplot(euEndUserSat, aes(x=Year, y=Counts)) + geom_bar(aes(fill=Level), stat="identity")

```

###*Pacific Rim:*

```{r}

prEndUserSat <- regionData(EndUserSat, 16,20, 3,8, yearsCols,dataTags)
ggplot(prEndUserSat, aes(x=Year, y=Counts)) + geom_bar(aes(fill=Level), position="dodge", stat="identity")
ggplot(prEndUserSat, aes(x=Year, y=Counts)) + geom_bar(aes(fill=Level), stat="identity")

```

###*China:*

```{r}

yearsInChinaCols <- c("2012", "2013", "2014")

chEndUserSat <- regionData(EndUserSat, 21,23, 3,8, yearsInChinaCols,dataTags)
ggplot(chEndUserSat, aes(x=Year, y=Counts)) + geom_bar(aes(fill=Level), position="dodge", stat="identity")
ggplot(chEndUserSat, aes(x=Year, y=Counts)) + geom_bar(aes(fill=Level), stat="identity")

```

### Step 2

```{r}

plot(Complaints$World, ylim=range(c(0, 400)), type="l", xlab="Month", ylab="Number of Complaints")
par(new=TRUE)
plot(Complaints$'NA', ylim=range(c(0,400)), type="l", col="red", axes = FALSE, xlab = "", ylab = "")
par(new=TRUE)
plot(Complaints$SA, ylim=range(c(0,400)), type="l", col="green", axes = FALSE, xlab = "", ylab = "")
par(new=TRUE)
plot(Complaints$Eur, ylim=range(c(0,400)), type="l", col="blue", axes = FALSE, xlab = "", ylab = "")
par(new=TRUE)
plot(Complaints$Pac, ylim=range(c(0,400)), type="l", col="magenta", axes = FALSE, xlab = "", ylab = "")
par(new=TRUE)
plot(Complaints$China, ylim=range(c(0,400)), type="l", col="deeppink4", axes = FALSE, xlab = "", ylab = "")

```

## Part 2

### Step 1

```{r}

summary(UnitShippingCost$Mowers) #summary(ShippingCost_Existing$Mowers)
summary(UnitShippingCost$Tractors) #summary(ShippingCost_Existing$Tractors)
# Where is the ShippingCost_Proposed coming from?
# summary(ShippingCost_Proposed$Mowers)
# summary(ShippingCost_Proposed$Tractors)

```

## Part 3

### Step 1

```{r}

str(CustomerSurvey2014)
summary(CustomerSurvey2014)

CustomerSurvey2014[is.na(CustomerSurvey2014)] <- "NorthA"
str(CustomerSurvey2014)

barplot(table(CustomerSurvey2014$Region))

hist(CustomerSurvey2014$Quality, main="Quality - Number of Responses", xlab="Level of Quality")

```

###*Other Stuff to Revisit:*

```{r}

seq(1,16)
seq(32)
c(4,4,2)

?apply

M <- matrix(seq(1,16), 4, 4)
M

# apply min/max to rows
apply(M, 1, min)
apply(M, 1, max)

# apply min/max to columns
apply(M, 2, min)
apply(M, 2, max)

# 3 dimensional array
M <- array( seq(32), dim = c(4,4,2) )
M

# apply sum across each M[*, , ] - i.e sum across 2nd and 3rd dimension
apply(M, 1, sum)

# apply sum across each M[*, , ] - i.e sum across 3rd dimension
apply(M, c(1,2), sum)

# result is two-dimension

```

```{r}

str(DealerSat)

```

```{r}

#View, Structure
#View(CustomerSurvey2014)
#str(CustomerSurvey2014)

#View(BladeWeight)
#str(BladeWeight)

## #Next identify the N/A rows
## is.na(BladeWeight$Sample)
## is.na(BladeWeight$Weight)

## #Next reverse tge vector of truefalse using a boolean-not operation
## BladeWeight[!is.na(BladeWeight$Sample),]

## #Delete the rows
## BladeWeight = BladeWeight[!is.na(BladeWeight$Sample),]

## #Verify it worked
## summary(BladeWeight$Sample)

## #Finally let's subset the data by region. ##
## View(Dealer_Sat)
## dealerSat_NA = Dealer_Sat[1:5,]
## dealerSat_NA
## View(dealerSat_NA)
## head(dealerSat_NA)

## tdealerSat_NA = t(dealerSat_NA[,3:8])
## tdealerSat_NA
## View(tdealerSat_NA)

## colnames(tdealerSat_NA) <- c("2010", "2011", "2012", "2013", "2014")
## head(tdealerSat_NA)
## colnames(tdealerSat_NA)

```



#### A Sample Plot

```{r}

# Define 2 vectors
cars <- c(1, 3, 6, 4, 9)
trucks <- c(2, 5, 4, 5, 12)

# Graph cars using a y axis that ranges from 0 to 12
plot(cars, type="o", col="blue", ylim=c(0,12))

# Graph trucks with red dashed line and square points
lines(trucks, type="o", pch=22, lty=2, col="red")

# Create a title with a red, bold/italic font
title(main="Autos", col.main="red", font.main=4)

```

## DELETE THIS CHUNK LATER
```{r}

#head(DealerSat)
#stat.desc(DealerSat)

#library(help = "stats")
#library(help = "pastecs")

```

# References

